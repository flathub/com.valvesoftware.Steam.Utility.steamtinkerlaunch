name: innoextract
buildsystem: cmake-ninja
sources:
  - type: archive
    url: https://github.com/dscharrer/innoextract/releases/download/1.9/innoextract-1.9.tar.gz
    sha256: 6344a69fc1ed847d4ed3e272e0da5998948c6b828cb7af39c6321aba6cf88126
    x-checker-data:
      type: anitya
      project-id: 8646
      stable-only: true
      url-template: https://github.com/dscharrer/innoextract/releases/download/$version/innoextract-$version.tar.gz
  # Patch innoextract failing to build with boost 1.85+: https://github.com/dscharrer/innoextract/pull/169
  - type: patch
    path: ../patches/innoextract-169.patch
  # Patch innoextract failing to build with boost 1.89+: https://github.com/dscharrer/innoextract/pull/199
  - type: patch
    path: ../patches/innoextract-199.patch
modules:
  - name: boost
    buildsystem: simple
    build-options:
      env:
        CMAKE_PREFIX_PATH: ${FLATPAK_DEST}
    build-commands:
      - ./bootstrap.sh --prefix=${FLATPAK_DEST} --with-libraries=date_time,filesystem,iostreams,program_options
      - ./b2 -j$FLATPAK_BUILDER_N_JOBS install
    sources:
      - type: archive
        url: https://archives.boost.io/release/1.89.0/source/boost_1_89_0.tar.gz
        sha256: 9de758db755e8330a01d995b0a24d09798048400ac25c03fc5ea9be364b13c93
        x-checker-data:
          type: anitya
          project-id: 6845
          stable-only: true
          url-template: https://archives.boost.io/release/$version/source/boost_${major}_${minor}_${patch}.tar.gz
    cleanup:
      - /lib/cmake
